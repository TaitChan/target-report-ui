"use strict";(self["webpackChunktarget_report_ui"]=self["webpackChunktarget_report_ui"]||[]).push([[598],{1382:function(t,e,a){a.d(e,{g:function(){return s}});var i=a(3541);function s(t){return JSON.parse(JSON.stringify(i.Hj))}},5353:function(t,e,a){a.d(e,{O:function(){return r},m:function(){return s}});var i=a(3541);function s(){return JSON.parse(JSON.stringify(i._u))}function r(){return JSON.parse(JSON.stringify(i.eA))}},9598:function(t,e,a){a.r(e),a.d(e,{default:function(){return G}});var i=a(6252),s=a(3577);const r={class:"flex flex-column height-100-percent"},l={class:"flex justify-space-between"},n=(0,i.Uk)(" 自定义指标卡 "),c=(0,i.Uk)(" 选择指标卡 "),o=(0,i.Uk)("取消"),d={class:"report-save flex-1 overflow-scroll padding-20px"},u={class:"edit-target-card flex flex-column padding-20px"},p={class:"flex justify-space-between pb-20px"},g={style:{"max-width":"300px"}},m={class:"flex align-center"},f=(0,i.Uk)("仅供参考"),h={class:"flex bg-gray-1 border-radius-6px color-info padding-2px"},v=["onClick"],w=["onClick"],_={class:"chart-item flex-1"};function L(t,e,a,L,T,y){const x=(0,i.up)("svg-icon"),k=(0,i.up)("el-button"),b=(0,i.up)("el-tooltip"),W=(0,i.up)("el-tag"),C=(0,i.up)("grid-item"),U=(0,i.up)("grid-layout"),A=(0,i.up)("report-save-drawer"),I=(0,i.up)("el-drawer");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",r,[(0,i._)("h3",l,[(0,i._)("div",null,[(0,i.Wm)(x,{"icon-class":"back",onClick:e[0]||(e[0]=e=>t.$router.go(-1))}),(0,i.Uk)(" "+(0,s.zw)(y.title)+(0,s.zw)(T.id),1)]),(0,i._)("div",null,[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(x,{"icon-class":"plus"}),n])),_:1}),(0,i.Wm)(k,{onClick:y.openDrawer},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{"icon-class":"plus"}),c])),_:1},8,["onClick"]),(0,i.Wm)(k,{onClick:y.handleCancel},{default:(0,i.w5)((()=>[o])),_:1},8,["onClick"]),(0,i.Wm)(k,{type:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(y.saveBtn),1)])),_:1})])]),(0,i._)("div",d,[(0,i.Wm)(U,{layout:T.editTargetList,"onUpdate:layout":e[1]||(e[1]=t=>T.editTargetList=t),"col-num":12,"is-draggable":!0,"is-resizable":!0,responsive:!1,"vertical-compact":!0,"use-css-transforms":!1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(T.editTargetList,((t,e)=>((0,i.wg)(),(0,i.j4)(C,{key:t.cardId,x:t.x,y:t.y,w:t.w,h:t.h,i:t.i},{default:(0,i.w5)((()=>[(0,i._)("div",u,[(0,i._)("div",p,[(0,i._)("div",null,[(0,i.Uk)((0,s.zw)(t.title)+" ",1),(0,i.Wm)(b,{placement:"top"},{content:(0,i.w5)((()=>[(0,i._)("div",g,(0,s.zw)(t.description),1)])),default:(0,i.w5)((()=>[(0,i.Wm)(x,{"icon-class":"question",class:"color-info"})])),_:2},1024)]),(0,i._)("div",m,[(0,i.Wm)(W,{type:"info",class:"mr-5px"},{default:(0,i.w5)((()=>[f])),_:1}),(0,i._)("div",h,[(0,i.Wm)(b,{content:"点击设置宽度50%",placement:"top"},{default:(0,i.w5)((()=>[(0,i._)("span",{style:{width:"2em"},class:(0,s.C_)(["flex align-center justify-center cursor-pointer",6===t.w?"color-primary border-radius-4px box-shadow-small bg-white":""]),onClick:e=>t.w=6},[(0,i.Wm)(x,{"icon-class":"layout-banhang",class:"font-size-20px"})],10,v)])),_:2},1024),(0,i.Wm)(b,{content:"点击设置宽度100%",placement:"top"},{default:(0,i.w5)((()=>[(0,i._)("span",{style:{width:"2em"},class:(0,s.C_)(["flex align-center justify-center cursor-pointer",12===t.w?"color-primary border-radius-4px box-shadow-small bg-white":""]),onClick:e=>t.w=12},[(0,i.Wm)(x,{"icon-class":"layout-zhenghang",class:"font-size-20px"})],10,w)])),_:2},1024)]),(0,i.Wm)(b,{content:"移除",placement:"top"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{link:"",type:"info",onClick:e=>y.handleDel(t.cardId),class:"ml-5px"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{"icon-class":"delete",class:"font-size-16px"})])),_:2},1032,["onClick"])])),_:2},1024)])]),(0,i._)("div",_,[((0,i.wg)(),(0,i.j4)((0,i.LL)(t.cardId)))])])])),_:2},1032,["x","y","w","h","i"])))),128))])),_:1},8,["layout"])])]),(0,i.Wm)(I,{modelValue:T.drawer,"onUpdate:modelValue":e[4]||(e[4]=t=>T.drawer=t),title:"选择指标卡",size:"min(800px,100%)","destroy-on-close":""},{default:(0,i.w5)((()=>[(0,i.Wm)(A,{onCancel:e[2]||(e[2]=t=>T.drawer=!1),onConfirm:e[3]||(e[3]=t=>T.drawer=!1)})])),_:1},8,["modelValue"])],64)}const T={class:"height-100-percent flex flex-column"},y={class:"flex-1 overflow-scroll"},x={class:"grid grid-gap-20px grid-template-columns-200px"},k=["onClick"],b={class:"pt-20px flex justify-space-between"},W=(0,i.Uk)(" 已选 "),C={class:"color-primary pl-10px pr-10px"},U=(0,i.Uk)(" 个选项卡 "),A=(0,i.Uk)("取消"),I=(0,i.Uk)("确定");function z(t,e,a,r,l,n){const c=(0,i.up)("el-tag"),o=(0,i.up)("el-tab-pane"),d=(0,i.up)("el-tabs"),u=(0,i.up)("svg-icon"),p=(0,i.up)("el-image"),g=(0,i.up)("el-tooltip"),m=(0,i.up)("el-button");return(0,i.wg)(),(0,i.iD)("div",T,[(0,i.Wm)(d,{modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=t=>l.activeTab=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.tabList,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t.name,label:t.label,name:t.name},{label:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.label)+" ",1),(0,i.Wm)(c,{effect:"light",round:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.count),1)])),_:2},1024)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"]),(0,i._)("div",y,[(0,i._)("div",x,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.filterTargetList,(t=>((0,i.wg)(),(0,i.iD)("div",{class:(0,s.C_)(["target-card",t.active?"active":""]),key:t.cardId,onClick:e=>t.active=!t.active},[t.active?((0,i.wg)(),(0,i.j4)(u,{key:0,"icon-class":"success-filled",class:"success-filled"})):(0,i.kq)("",!0),(0,i._)("div",null,[(0,i.Wm)(p,{src:t.picUrl,style:{height:"140px"}},null,8,["src"])]),(0,i._)("div",null,[(0,i.Uk)((0,s.zw)(t.title)+" ",1),(0,i.Wm)(g,{content:t.description,placement:"top"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{"icon-class":"question",class:"color-info"})])),_:2},1032,["content"])])],10,k)))),128))])]),(0,i._)("div",b,[(0,i._)("div",null,[W,(0,i._)("span",C,(0,s.zw)(n.drawerActiveTargetList.length)+"/"+(0,s.zw)(l.targetList.length),1),U]),(0,i._)("div",null,[(0,i.Wm)(m,{onClick:e[1]||(e[1]=e=>t.$emit("cancel"))},{default:(0,i.w5)((()=>[A])),_:1}),(0,i.Wm)(m,{type:"primary",onClick:n.handleImport},{default:(0,i.w5)((()=>[I])),_:1},8,["onClick"])])])])}var D=a(5353),S=a(5684);const j=(0,S.Q_)({id:"cart",state:()=>({activeTargetList:[]}),getters:{},actions:{setActiveTargetList(t){this.activeTargetList=t},delActiveTarget(t){this.activeTargetList.splice(this.activeTargetList.findIndex((e=>e.cardId===t)),1)},clearActiveTarget(){this.activeTargetList=[]}}});var O={name:"ReportSaveDrawer",components:{},data(){return{tabList:[],activeTab:"all",targetList:[]}},computed:{...(0,S.rn)(j,["activeTargetList"]),drawerActiveTargetList(){return this.targetList.filter((t=>t.active))},filterTargetList(){return"all"===this.activeTab?this.targetList:this.targetList.filter((t=>t.category===this.activeTab))}},created(){this.getTabList(),this.getTargetList()},methods:{...(0,S.nv)(j,["setActiveTargetList"]),handleImport(){let t=[];this.drawerActiveTargetList.forEach(((e,a)=>{let i=this.activeTargetList.find((t=>t.cardId===e.cardId));i?t.push({...i,y:0,i:a}):t.push({...e,x:0,y:0,w:e.w||12,h:e.h||2,i:a})})),this.setActiveTargetList(t),this.$emit("confirm")},async getTabList(){const{data:t}=await(0,D.O)();this.tabList=t},async getTargetList(){const{data:t}=await(0,D.m)();this.targetList=t,this.tabList.unshift({label:"全部指标卡",name:"all",count:t.length}),this.targetList.forEach((t=>{this.activeTargetList.forEach((e=>{t.cardId===e.cardId&&(t.active=e.active)}))}))}}},E=a(3744);const J=(0,E.Z)(O,[["render",z],["__scopeId","data-v-a0ae0e76"]]);var N=J,$=a(1382),V=a(7502),B=a(7147),H={name:"ReportSave",components:{SvgIcon:B["default"],ReportSaveDrawer:N,GridLayout:V.GridLayout,GridItem:V.GridItem},data(){return{id:this.$route.params.id||"",drawer:!1,grid:void 0,editTargetList:[]}},computed:{...(0,S.rn)(j,["activeTargetList"]),isEdit(){return Boolean(this.$route.params.id)},title(){return this.isEdit?"修改报表":"新建报表"},saveBtn(){return this.isEdit?"更新":"保存"}},watch:{activeTargetList:{handler(t){this.editTargetList=t},deep:!0}},created(){this.isEdit?this.getReportDetail():this.clearActiveTarget()},mounted(){},methods:{...(0,S.nv)(j,["setActiveTargetList","delActiveTarget","clearActiveTarget"]),async getReportDetail(){const{data:t}=(0,$.g)(this.id);t.forEach((t=>{t.active=!0})),this.editTargetList=t},openDrawer(){this.drawer=!0,console.log(JSON.stringify(this.editTargetList)),this.setActiveTargetList(this.editTargetList)},handleDel(t){this.setActiveTargetList(this.editTargetList),this.delActiveTarget(t)},handleCancel(){this.$confirm("离开后将不保留编辑内容","确认要离开当前编辑页面吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{this.$router.go(-1)})).catch((()=>{console.log("1")}))}},unmounted(){this.clearActiveTarget()}};const R=(0,E.Z)(H,[["render",L],["__scopeId","data-v-8b11ef26"]]);var G=R}}]);